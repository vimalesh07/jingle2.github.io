<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Your Virtual Christmas Gift</title>
    <!-- Fonts -->
    <link
        href="https://fonts.googleapis.com/css2?family=Dancing+Script:wght@400;700&family=Poppins:wght@300;400;600&display=swap"
        rel="stylesheet">
    <!-- Styles -->
    <link rel="stylesheet" href="css/base.css">
    <link rel="stylesheet" href="css/gift.css">
    <link rel="stylesheet" href="css/animations.css">
    <link rel="stylesheet" href="css/snowfall.css">
    <!-- Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>

<body class="open-page">
    <div class="snowflakes" aria-hidden="true"></div>

    <div class="container animate-fade-in" style="padding-top: 50px;">
        <div class="gift-message">
            <h1><i class="fas fa-gift"></i> A Gift For You</h1>
            <p id="greeting" style="font-size: 1.2rem; margin-top: 10px;">Click the gift box to unwrap your surprise!
            </p>
        </div>

        <!-- 3D Gift Box Container -->
        <div class="gift-container" id="giftBoxContainer">
            <div class="gift-box" id="giftBox">
                <div class="box">
                    <div class="side front"></div>
                    <div class="side back"></div>
                    <div class="side left"></div>
                    <div class="side right"></div>
                    <div class="side top">
                        <div class="ribbon-vertical"></div>
                        <div class="ribbon-horizontal"></div>
                        <div class="bow"></div>
                    </div>
                    <div class="side bottom"></div>
                </div>
            </div>
        </div>

        <button id="openBtn" class="btn-primary animate-pulse" style="margin-top: 50px;">
            <i class="fas fa-box-open"></i> Open Gift
        </button>
    </div>

    <!-- Revealed Content Area (Story Mode) -->
    <div class="gift-content" id="giftContent">

        <!-- Step 1: Photo Memory -->
        <div id="step1" class="story-step" style="display: none;">
            <div class="photo-memory glass-card animate-float-in">
                <h2><i class="fas fa-camera"></i> A Special Memory</h2>
                <div class="photo-container"
                    style="margin: 20px 0; border: 5px solid white; transform: rotate(-2deg); box-shadow: 0 5px 15px rgba(0,0,0,0.3);">
                    <img id="giftPhoto" src="" alt="Special Memory" style="max-width: 100%; display: block;">
                </div>
                <p class="photo-message" id="photoMessage" style="font-style: italic;"></p>
                <button class="btn-primary next-btn animate-pulse" onclick="nextStep(2)">
                    Read Letter <i class="fas fa-arrow-right"></i>
                </button>
            </div>
        </div>

        <!-- Step 2: Animated Envelope -->
        <div id="step2" class="story-step" style="display: none;">
            <div class="envelope-container glass-card animate-float-in"
                style="perspective: 1000px; background: transparent; box-shadow: none;">
                <h2><i class="fas fa-envelope-open-text"></i> A Letter For You</h2>
                <div class="envelope-wrapper" id="envelopeWrapper" style="margin: 30px auto;">
                    <div class="envelope" id="envelope">
                        <div class="envelope-flap"></div>
                        <div class="letter">
                            <div class="letter-content" id="letterContent" style="text-align: left;">
                                <!-- Letter content injected via JS -->
                            </div>
                        </div>
                    </div>
                </div>
                <p class="envelope-instructions" id="envInstr">Tap the envelope to read</p>

                <!-- Hidden initially, shown after opening letter -->
                <button id="btnToAudio" class="btn-primary next-btn animate-fade-in"
                    style="display: none; margin-top: 20px;" onclick="nextStep(3)">
                    Hear Voice Message <i class="fas fa-volume-up"></i>
                </button>
            </div>
        </div>

        <!-- Step 3: Voice Message -->
        <div id="step3" class="story-step" style="display: none;">
            <div class="voice-message glass-card animate-float-in">
                <h2><i class="fas fa-microphone"></i> Voice Message</h2>
                <div class="voice-visualizer"
                    style="height: 60px; display: flex; align-items: center; justify-content: center; gap: 5px; margin: 20px 0;">
                    <!-- Fake visualizer bars -->
                    <div class="bar"
                        style="height: 20px; width: 6px; background: var(--primary-gold); animation: sound 1s infinite;">
                    </div>
                    <div class="bar"
                        style="height: 30px; width: 6px; background: var(--primary-gold); animation: sound 0.8s infinite;">
                    </div>
                    <div class="bar"
                        style="height: 40px; width: 6px; background: var(--primary-gold); animation: sound 1.2s infinite;">
                    </div>
                    <div class="bar"
                        style="height: 25px; width: 6px; background: var(--primary-gold); animation: sound 0.9s infinite;">
                    </div>
                    <div class="bar"
                        style="height: 15px; width: 6px; background: var(--primary-gold); animation: sound 1.1s infinite;">
                    </div>
                </div>
                <audio id="voiceAudio" controls style="width: 100%; margin-top: 15px;"></audio>

                <div class="actions" style="margin-top: 40px;">
                    <button id="replayBtn" class="btn-secondary" onclick="location.reload()"><i class="fas fa-redo"></i>
                        Replay</button>
                    <button id="createOwnBtn" class="btn-primary" onclick="window.location.href='index.html'"><i
                            class="fas fa-magic"></i> Create Your Own</button>
                </div>
            </div>
        </div>

    </div>

    <div class="open-instructions animate-slide-up delay-2"
        style="position: fixed; bottom: 20px; width: 100%; text-align: center; font-size: 0.8rem; opacity: 0.7;">
        <p><i class="fas fa-volume-up"></i> Turn on sound for the best experience</p>
    </div>

    <!-- Scripts -->
    <script src="js/database.js" type="module"></script>
    <script src="js/snowfall.js"></script>
    <script src="js/voice.js" type="module"></script>
    <script src="js/openGift.js" type="module"></script>
</body>

</html>